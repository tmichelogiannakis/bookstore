(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{lXdu:function(e,t,n){"use strict";n.r(t),n.d(t,"BooksModule",(function(){return Ze}));var i=n("tyNb"),o=n("PCNd"),b=n("fXoL"),c=n("6hH2");let r=(()=>{class e{constructor(e,t){this.router=e,this.breadcrumbService=t}ngOnInit(){this.breadcrumbService.pushItem({id:"books",label:"Books",routerLink:["/books"]})}ngOnDestroy(){this.breadcrumbService.removeItem("books")}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(i.c),b.Lb(c.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["app-books"]],decls:1,vars:0,template:function(e,t){1&e&&b.Mb(0,"router-outlet")},directives:[i.h],styles:[""]}),e})();var l=n("lJxs");const s=e=>{let t=e.published;return isNaN(Number(t))&&(t=new Date(t).getFullYear()),Object.assign(Object.assign({},e),{published:t})};var a=n("tk/3");let u=(()=>{class e{constructor(e){this.http=e,this.endpoints={books:"/books",booksGenres:"/book-genres"}}getAllBooks(){return this.http.get(this.endpoints.books).pipe(Object(l.a)(e=>e.map(s)))}createBook(e){return this.http.post(this.endpoints.books,e)}updateBook(e,t){return this.http.put(`${this.endpoints.books}/${e}`,t)}deleteBook(e){return this.http.delete(`${this.endpoints.books}/${e}`)}getBook(e){return this.http.get(`${this.endpoints.books}/${e}`).pipe(Object(l.a)(s))}getSimilarBooks(e){return this.http.get(`${this.endpoints.books}/${e}/similar`).pipe(Object(l.a)(e=>e.map(s)))}getAllBookGenres(){return this.http.get(this.endpoints.booksGenres)}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(a.b))},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),d=(()=>{class e{constructor(e){this.bookService=e}resolve(e,t){return this.bookService.getAllBookGenres()}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(u))},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),p=(()=>{class e{constructor(e){this.bookService=e}resolve(e,t){return this.bookService.getAllBooks()}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(u))},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),h=(()=>{class e{constructor(e){this.bookService=e}resolve(e,t){const{isbn:n}=e.params;return this.bookService.getBook(n)}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(u))},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),f=(()=>{class e{constructor(e){this.bookService=e}resolve(e,t){const{isbn:n}=e.params;return this.bookService.getSimilarBooks(n)}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(u))},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=n("XNiG"),m=n("1G5W"),k=n("7zfz"),v=n("jIHw"),y=n("ofXK"),R=n("Hr28"),Q=n("Nf9I"),w=n("3Pt+"),z=n("7kUa"),O=n("arFO"),I=n("+la4"),M=n("lVkt"),P=n("yT6U");function x(e,t){1&e&&b.Nb(0)}let L=(()=>{class e{constructor(){}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"actions":this.actionsTemplate=e.template}})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=b.Fb({type:e,selectors:[["app-book-tile"]],contentQueries:function(e,t,n){var i;1&e&&b.Eb(n,k.e,!1),2&e&&b.oc(i=b.Zb())&&(t.templates=i)},inputs:{book:"book"},decls:14,vars:8,consts:[[1,"p-grid","p-nogutter","tile-book"],[1,"p-col-fixed"],[1,"tile-book-image",3,"src","alt"],[1,"p-col"],[1,"tile-book-content"],[1,"tile-book-title"],[1,"tile-book-author"],[1,"p-grid","p-nogutter","p-justify-end"],[4,"ngTemplateOutlet"]],template:function(e,t){1&e&&(b.Rb(0,"article",0),b.Rb(1,"div",1),b.Mb(2,"img",2),b.Qb(),b.Rb(3,"div",3),b.Rb(4,"div",4),b.Rb(5,"div"),b.Rb(6,"h4",5),b.yc(7),b.Qb(),b.Rb(8,"p",6),b.yc(9),b.cc(10,"array"),b.Qb(),b.Qb(),b.Rb(11,"div",7),b.Rb(12,"div"),b.wc(13,x,1,0,"ng-container",8),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e&&(b.zb(2),b.hc("src",t.book.image||"./assets/images/missing-image.png",b.sc)("alt",t.book.title),b.zb(5),b.zc(t.book.title),b.zb(2),b.Ac("by ",b.ec(10,5,t.book.author,", "),""),b.zb(4),b.hc("ngTemplateOutlet",t.actionsTemplate))},directives:[y.m],pipes:[P.a],styles:[".tile-book[_ngcontent-%COMP%]{border:1px solid #edebe9;border-radius:.125rem;background-color:#fff}.tile-book[_ngcontent-%COMP%]   .tile-book-image[_ngcontent-%COMP%]{width:6rem;height:8rem;object-fit:cover;display:block}.tile-book[_ngcontent-%COMP%]   .tile-book-content[_ngcontent-%COMP%]{padding:.5rem;height:100%;display:flex;flex-direction:column;justify-content:space-between}.tile-book[_ngcontent-%COMP%]   .tile-book-title[_ngcontent-%COMP%]{font-size:1rem;margin-top:0;margin-bottom:.5rem}.tile-book[_ngcontent-%COMP%]   .tile-book-author[_ngcontent-%COMP%]{font-size:.875rem;margin-top:0;margin-bottom:.5rem}"],changeDetection:0}),e})();function C(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"p-multiSelect",26),b.Yb("onChange",(function(t){return b.qc(e),b.bc(2).filter(t)}))("ngModelChange",(function(t){return b.qc(e),b.bc(2).filters.categories.value=t})),b.Qb(),b.Ob()}if(2&e){const e=t.ngIf,n=b.bc(2);b.zb(1),b.hc("ngModel",n.filters.categories.value)("options",e)("selectionLimit",8)("maxSelectedLabels",1)("selectedItemsLabel","{0} categories selected")("inputId","categories")("defaultLabel","Categories")("showToggleAll",!1)}}const S=function(e){return{left:e}};function B(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",13),b.Rb(1,"div",0),b.Rb(2,"div",1),b.Rb(3,"div",0),b.Rb(4,"div",2),b.Rb(5,"label",14),b.Mb(6,"i",15),b.Qb(),b.Qb(),b.Rb(7,"div",1),b.Rb(8,"input",16),b.Yb("ngModelChange",(function(t){return b.qc(e),b.bc().globalFilter.value=t}))("input",(function(t){return b.qc(e),b.bc().filter(t)})),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(9,"div",1),b.wc(10,C,2,8,"ng-container",17),b.cc(11,"async"),b.Qb(),b.Rb(12,"div",1),b.Rb(13,"p-dropdown",18),b.Yb("onChange",(function(t){return b.qc(e),b.bc().filter(t)}))("ngModelChange",(function(t){return b.qc(e),b.bc().filters.author.value=t})),b.Qb(),b.Qb(),b.Rb(14,"div",1),b.Rb(15,"div",19),b.Rb(16,"div",20),b.Rb(17,"label",21),b.yc(18,"Published Year"),b.Qb(),b.Qb(),b.Rb(19,"p-slider",22,23),b.Yb("ngModelChange",(function(t){return b.qc(e),b.bc().filters.published.value=t}))("onChange",(function(t){return b.qc(e),b.bc().filter(t)})),b.Qb(),b.Rb(21,"div",24),b.Rb(22,"span",25),b.yc(23),b.Qb(),b.Rb(24,"span",25),b.yc(25),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.pc(20),t=b.bc();b.zb(8),b.hc("ngModel",t.globalFilter.value),b.zb(2),b.hc("ngIf",b.dc(11,13,t.genreSelectItems$)),b.zb(3),b.hc("ngModel",t.filters.author.value)("options",t.authors)("inputId","authors"),b.zb(6),b.hc("ngModel",t.filters.published.value)("range",!0)("min",t.publishedBound[0])("max",t.publishedBound[1]),b.zb(3),b.hc("ngStyle",b.jc(15,S,e.rangeStartLeft)),b.zb(1),b.zc(t.filters.published.value[0]),b.zb(1),b.hc("ngStyle",b.jc(17,S,e.rangeEndLeft)),b.zb(1),b.zc(t.filters.published.value[1])}}const j=function(e){return[e]},A=function(e){return[e,"view"]};function T(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",27),b.Rb(1,"article",28),b.Rb(2,"div",29),b.Rb(3,"div",2),b.Mb(4,"img",30),b.Qb(),b.Rb(5,"div",1),b.Rb(6,"div",31),b.Rb(7,"div"),b.Rb(8,"h4",32),b.yc(9),b.Qb(),b.Rb(10,"p",33),b.yc(11),b.cc(12,"array"),b.Qb(),b.Rb(13,"div",34),b.yc(14),b.Qb(),b.Rb(15,"li"),b.yc(16),b.Qb(),b.Rb(17,"li"),b.yc(18),b.Qb(),b.Rb(19,"li"),b.yc(20),b.Qb(),b.Qb(),b.Rb(21,"div",35),b.Rb(22,"div"),b.Mb(23,"a",36),b.Mb(24,"a",36),b.Rb(25,"a",37),b.Yb("click",(function(){b.qc(e);const n=t.$implicit;return b.bc().confirmDeletion(n)})),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=t.$implicit;b.zb(4),b.hc("src",e.image||"./assets/images/missing-image.png",b.sc)("alt",e.title),b.zb(5),b.zc(e.title),b.zb(2),b.Ac("by ",b.ec(12,13,e.author,", "),""),b.zb(3),b.zc(e.description),b.zb(2),b.Ac("ISBN: ",e.isbn,""),b.zb(2),b.Ac("Published Year: ",e.published,""),b.zb(2),b.Ac("Publisher: ",e.publisher,""),b.zb(3),b.hc("routerLink",b.jc(16,j,e.isbn))("label","Edit"),b.zb(1),b.hc("routerLink",b.jc(18,A,e.isbn))("label","View"),b.zb(1),b.hc("label","Delete")}}function q(e,t){if(1&e){const e=b.Sb();b.Mb(0,"a",41),b.Mb(1,"a",41),b.Rb(2,"a",42),b.Yb("click",(function(){b.qc(e);const t=b.bc().$implicit;return b.bc().confirmDeletion(t)})),b.Qb()}if(2&e){const e=b.bc().$implicit;b.hc("routerLink",b.jc(5,j,e.isbn))("label","Edit"),b.zb(1),b.hc("routerLink",b.jc(7,A,e.isbn))("label","View"),b.zb(1),b.hc("label","Delete")}}function F(e,t){if(1&e&&(b.Rb(0,"div",38),b.Rb(1,"app-book-tile",39),b.wc(2,q,3,9,"ng-template",40),b.Qb(),b.Qb()),2&e){const e=t.$implicit;b.zb(1),b.hc("book",e)}}const N=function(){return["add"]};let _=(()=>{class e{constructor(e,t,n){this.route=e,this.confirmationService=t,this.bookService=n,this.unsubscribe=new g.a,this.globalFilter={fields:["title"],value:""},this.filters={categories:{value:null,matchMode:"in"},published:{value:[],matchMode:"<>"},author:{value:null,matchMode:"in"}}}ngOnInit(){this.route.data.pipe(Object(m.a)(this.unsubscribe),Object(l.a)(e=>e.books)).subscribe(e=>{this.books=e,this.calculateFilters(e)}),this.genreSelectItems$=this.route.parent.data.pipe(Object(m.a)(this.unsubscribe),Object(l.a)(e=>e.bookGenres),Object(l.a)(e=>e.map(e=>({label:e.label,value:e.id}))))}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}filter(e){this.filters=Object.assign({},this.filters)}calculateFilters(e){const t=e.map(e=>e.published),n=Math.min(...t),i=Math.max(...t);this.publishedBound=[n,i],this.filters.published.value=[n,i],this.authors=e.reduce((e,t)=>{const n=t.author;return Array.isArray(n)?[...e,...n]:[...e,n]},[]).filter((e,t,n)=>n.indexOf(e)==t).map(e=>({label:e,value:e})),this.authors=[{label:"Author",value:""},...this.authors]}confirmDeletion(e){this.confirmationService.confirm({message:`Are you sure you want to delete the book "${e.title}"?`,accept:()=>{this.bookService.deleteBook(e.isbn).pipe(Object(m.a)(this.unsubscribe)).subscribe(t=>{this.books=this.books.filter(t=>t.isbn!==e.isbn)},e=>{})},reject:()=>{}})}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(i.a),b.Lb(k.a),b.Lb(u))},e.\u0275cmp=b.Fb({type:e,selectors:[["app-book-list"]],features:[b.yb([k.a])],decls:16,vars:9,consts:[[1,"p-grid","p-align-center"],[1,"p-col"],[1,"p-col-fixed"],["pButton","","label","New book",3,"icon","routerLink"],["class","filter-area",4,"ngIf"],[1,"p-mb-3"],[3,"items","globalFilter","filters","emptyMessage"],["pTemplate","listItem"],["pTemplate","gridItem"],["appendTo","body","styleClass","ui-dialog-headless",3,"closable"],["cd",""],["pButton","","label","CANCEL","tabindex","0","autofocus","",3,"click"],["pButton","","label","DELETE","tabindex","1",1,"ui-button-danger",3,"click"],[1,"filter-area"],["for","search"],[1,"pi","pi-filter"],["type","search","id","search","pInputText","",3,"ngModel","ngModelChange","input"],[4,"ngIf"],[3,"ngModel","options","inputId","onChange","ngModelChange"],[1,"p-px-3"],[1,"text-center","p-pb-1"],["for","slider"],[3,"ngModel","range","min","max","ngModelChange","onChange"],["slider",""],[1,"ui-slider-labels"],[1,"ui-slider-label",3,"ngStyle"],[3,"ngModel","options","selectionLimit","maxSelectedLabels","selectedItemsLabel","inputId","defaultLabel","showToggleAll","onChange","ngModelChange"],[1,"p-col-12"],[1,"list-item-book"],[1,"p-grid","p-nogutter"],[1,"list-item-book-image",3,"src","alt"],[1,"list-item-book-content"],[1,"list-item-book-title"],[1,"list-item-book-author"],[1,"p-mb-2"],[1,"p-grid","p-nogutter","p-justify-end"],["pButton","",3,"routerLink","label"],["pButton","",1,"ui-button-danger",3,"label","click"],[1,"p-col-12","p-sm-6","p-md-4","p-py-2"],[3,"book"],["pTemplate","actions"],["pButton","",1,"ui-button-sm",3,"routerLink","label"],["pButton","",1,"ui-button-sm","ui-button-danger",3,"label","click"]],template:function(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",0),b.Rb(1,"div",1),b.Rb(2,"h1"),b.yc(3,"Search to find your new book"),b.Qb(),b.Qb(),b.Rb(4,"div",2),b.Mb(5,"a",3),b.Qb(),b.Qb(),b.wc(6,B,26,19,"div",4),b.Rb(7,"div",5),b.Rb(8,"app-dataview",6),b.wc(9,T,26,20,"ng-template",7),b.wc(10,F,3,1,"ng-template",8),b.Qb(),b.Qb(),b.Rb(11,"p-confirmDialog",9,10),b.Rb(13,"p-footer"),b.Rb(14,"button",11),b.Yb("click",(function(){return b.qc(e),b.pc(12).reject()})),b.Qb(),b.Rb(15,"button",12),b.Yb("click",(function(){return b.qc(e),b.pc(12).accept()})),b.Qb(),b.Qb(),b.Qb()}2&e&&(b.zb(5),b.hc("icon","pi pi-plus")("routerLink",b.ic(8,N)),b.zb(1),b.hc("ngIf",t.books),b.zb(2),b.hc("items",t.books)("globalFilter",t.globalFilter)("filters",t.filters)("emptyMessage","No books found"),b.zb(3),b.hc("closable",!1))},directives:[i.f,v.b,y.k,R.a,k.e,Q.a,k.b,w.a,z.a,w.g,w.i,O.a,I.a,y.l,M.a,L],pipes:[y.b,P.a],styles:[".filter-area[_ngcontent-%COMP%]{background-color:#f0f0f0;padding:1rem}.list-item-book[_ngcontent-%COMP%]{margin-bottom:.5rem;background-color:#fff;border:1px solid #edebe9}.list-item-book[_ngcontent-%COMP%]   .list-item-book-image[_ngcontent-%COMP%]{width:12rem;height:16rem;object-fit:cover;display:block}.list-item-book[_ngcontent-%COMP%]   .list-item-book-content[_ngcontent-%COMP%]{padding:1rem;height:100%;display:flex;flex-direction:column;justify-content:space-between}.list-item-book[_ngcontent-%COMP%]   .list-item-book-content[_ngcontent-%COMP%]   .list-item-book-title[_ngcontent-%COMP%]{font-size:1rem;margin-top:0;margin-bottom:.25rem}.list-item-book[_ngcontent-%COMP%]   .list-item-book-content[_ngcontent-%COMP%]   .list-item-book-author[_ngcontent-%COMP%]{font-size:.875rem;margin-top:0;margin-bottom:.5rem}"]}),e})();var D=n("HDdC");let $=(()=>{class e{canDeactivate(e,t,n,i){return!e.form.dirty||new D.a(t=>{e.confirmationService.confirm({message:"You have unsaved changes. Do you want to leave this page and discard your changes?",accept:()=>{t.next(!0),t.complete()},reject:()=>{t.next(!1),t.complete()}})})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Y(e,t){1&e&&(b.Pb(0),b.yc(1,", "),b.Ob())}function E(e,t){if(1&e&&(b.Pb(0),b.yc(1),b.wc(2,Y,2,0,"ng-container",7),b.Ob()),2&e){const e=t.$implicit,n=t.last,i=b.bc(4);b.zb(1),b.Ac(" #",i.bookGenreMap[e],""),b.zb(1),b.hc("ngIf",!n)}}function G(e,t){if(1&e&&(b.Rb(0,"li"),b.yc(1," Categories: "),b.wc(2,E,3,2,"ng-container",11),b.Qb()),2&e){const e=b.bc().ngIf,t=b.bc(2);b.zb(2),b.hc("ngForOf",e)("ngForTrackBy",t.categoryTrackBy)}}function V(e,t){if(1&e&&(b.Pb(0),b.wc(1,G,3,2,"li",7),b.Ob()),2&e){const e=t.ngIf;b.zb(1),b.hc("ngIf",e.length)}}function H(e,t){if(1&e&&(b.Pb(0),b.wc(1,V,2,1,"ng-container",7),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.book.categories)}}function Z(e,t){if(1&e&&(b.Rb(0,"li"),b.yc(1," Website: "),b.Rb(2,"a",12),b.yc(3),b.Qb(),b.Qb()),2&e){const e=b.bc();b.zb(2),b.hc("href",e.book.website,b.sc),b.zb(1),b.Ac(" ",e.book.website,"")}}const J=function(e){return["../../",e]},X=function(e){return["../../",e,"view"]};function W(e,t){if(1&e&&(b.Mb(0,"a",17),b.Mb(1,"a",17)),2&e){const e=b.bc().$implicit;b.hc("routerLink",b.jc(4,J,e.isbn))("label","Edit"),b.zb(1),b.hc("routerLink",b.jc(6,X,e.isbn))("label","View")}}function U(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",14),b.Rb(2,"app-book-tile",15),b.wc(3,W,2,8,"ng-template",16),b.Qb(),b.Qb(),b.Ob()),2&e){const e=t.$implicit;b.zb(2),b.hc("book",e)}}function K(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"h2"),b.yc(2,"Other Books you may like"),b.Qb(),b.Rb(3,"div",13),b.wc(4,U,4,1,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf,n=b.bc();b.zb(4),b.hc("ngForOf",e)("ngForTrackBy",n.booksTrackBy)}}const ee=function(){return["../"]},te=function(){return["../../"]};let ne=(()=>{class e{constructor(e,t){this.route=e,this.breadcrumbService=t,this.unsubscribe=new g.a}ngOnInit(){this.similarBooks$=this.route.data.pipe(Object(l.a)(e=>e.similarBooks)),this.route.parent.data.pipe(Object(l.a)(e=>e.bookGenres),Object(m.a)(this.unsubscribe)).subscribe(e=>{this.bookGenreMap=e.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.id]:t.label}),{})}),this.route.data.pipe(Object(l.a)(e=>e.book),Object(m.a)(this.unsubscribe)).subscribe(e=>{this.book=e,this.breadcrumbService.pushItem({id:"books-view",label:e.title,routerLink:["/books",e.isbn,"view"]})})}ngOnDestroy(){this.breadcrumbService.removeItem("books-view"),this.unsubscribe.next(),this.unsubscribe.complete()}categoryTrackBy(e,t){return t}booksTrackBy(e,t){return t.isbn}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(i.a),b.Lb(c.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["app-view-book"]],decls:32,vars:22,consts:[[1,"main-book"],[1,"p-grid","p-nogutter"],[1,"p-col-fixed"],[1,"image",3,"src","alt"],[1,"p-col","column-content"],[1,"p-my-0"],[1,"p-mt-1","p-mb-0"],[4,"ngIf"],[1,"p-grid","p-mt-3","p-justify-end"],["pButton","","type","button","label","Edit",3,"routerLink"],["pButton","","type","button","label","Back",3,"routerLink"],[4,"ngFor","ngForOf","ngForTrackBy"],["target","_blank",3,"href"],[1,"p-grid"],[1,"p-col-12","p-sm-6","p-md-4","p-py-2"],[3,"book"],["pTemplate","actions"],["pButton","",1,"ui-button-sm",3,"routerLink","label"]],template:function(e,t){1&e&&(b.Rb(0,"div",0),b.Rb(1,"div",1),b.Rb(2,"div",2),b.Mb(3,"img",3),b.Qb(),b.Rb(4,"div",4),b.Rb(5,"h1",5),b.yc(6),b.Qb(),b.Rb(7,"h4",6),b.yc(8),b.Qb(),b.Rb(9,"div"),b.Rb(10,"ul"),b.Rb(11,"li"),b.yc(12),b.cc(13,"array"),b.Qb(),b.wc(14,H,2,1,"ng-container",7),b.Rb(15,"li"),b.yc(16),b.Qb(),b.Rb(17,"li"),b.yc(18),b.Qb(),b.Rb(19,"li"),b.yc(20),b.Qb(),b.Rb(21,"li"),b.yc(22),b.Qb(),b.wc(23,Z,4,2,"li",7),b.Qb(),b.Qb(),b.Rb(24,"div"),b.yc(25),b.Qb(),b.Qb(),b.Qb(),b.Rb(26,"div",8),b.Rb(27,"div",2),b.Mb(28,"button",9),b.Mb(29,"button",10),b.Qb(),b.Qb(),b.Qb(),b.wc(30,K,5,2,"ng-container",7),b.cc(31,"async")),2&e&&(b.zb(3),b.hc("src",t.book.image||"./assets/images/missing-image.png",b.sc)("alt",t.book.title),b.zb(3),b.zc(t.book.title),b.zb(2),b.zc(t.book.subtitle),b.zb(4),b.Ac("Author: ",b.ec(13,15,t.book.author,", "),""),b.zb(2),b.hc("ngIf",t.bookGenreMap),b.zb(2),b.Ac("ISBN: ",t.book.isbn,""),b.zb(2),b.Ac("Published Year: ",t.book.published,""),b.zb(2),b.Ac("Pages: ",t.book.pages,""),b.zb(2),b.Ac("Publisher: ",t.book.publisher,""),b.zb(1),b.hc("ngIf",t.book.website),b.zb(2),b.zc(t.book.description),b.zb(3),b.hc("routerLink",b.ic(20,ee)),b.zb(1),b.hc("routerLink",b.ic(21,te)),b.zb(1),b.hc("ngIf",b.dc(31,18,t.similarBooks$)))},directives:[y.k,v.b,i.d,y.j,L,k.e,i.f],pipes:[P.a,y.b],styles:[".main-book[_ngcontent-%COMP%]{border-radius:.125rem;background-color:#fff;display:block;padding:1rem;box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,.132),0 .3px .9px 0 rgba(0,0,0,.108)}.main-book[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{max-width:12rem}.main-book[_ngcontent-%COMP%]   .column-content[_ngcontent-%COMP%]{padding-left:1rem}"]}),e})();var ie=n("pLZG"),oe=n("9uVP");class be{static range(e,t){return n=>{if(Object(oe.a)(n.value)||Object(oe.a)(e)||Object(oe.a)(t))return null;const i=parseFloat(n.value);return!isNaN(i)&&(i<e||i>t)?{range:{min:e,max:t,actual:n.value}}:null}}}var ce=n("VeYp"),re=n("zFJ7"),le=n("RGqm");function se(e,t){1&e&&(b.Pb(0),b.yc(1," Fill out the title "),b.Ob())}function ae(e,t){if(1&e&&(b.Pb(0),b.yc(1),b.Ob()),2&e){const e=b.bc().ngIf;b.zb(1),b.Ac(" The title is too long (max ",null==e||null==e.maxlength?null:e.maxlength.requiredLength," characters allowed). ")}}function ue(e,t){1&e&&(b.Pb(0),b.yc(1,' Only letter, numbers and @"#&*! are allowed '),b.Ob())}function de(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"small",39),b.wc(2,se,2,0,"ng-container",11),b.wc(3,ae,2,1,"ng-container",11),b.wc(4,ue,2,0,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf;b.zb(2),b.hc("ngIf",null==e?null:e.required),b.zb(1),b.hc("ngIf",null==e?null:e.maxlength),b.zb(1),b.hc("ngIf",null==e?null:e.pattern)}}function pe(e,t){if(1&e&&(b.Pb(0),b.wc(1,de,5,3,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.title.errors)}}function he(e,t){if(1&e&&(b.Pb(0),b.yc(1),b.Ob()),2&e){const e=b.bc().ngIf;b.zb(1),b.Ac(" The subtitle is too long (max ",null==e||null==e.maxlength?null:e.maxlength.requiredLength," characters allowed). ")}}function fe(e,t){1&e&&(b.Pb(0),b.yc(1,' Only letter, numbers and @"#&*! are allowed '),b.Ob())}function ge(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"small",40),b.wc(2,he,2,1,"ng-container",11),b.wc(3,fe,2,0,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf;b.zb(2),b.hc("ngIf",null==e?null:e.maxlength),b.zb(1),b.hc("ngIf",null==e?null:e.pattern)}}function me(e,t){if(1&e&&(b.Pb(0),b.wc(1,ge,4,2,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.subtitle.errors)}}function ke(e,t){1&e&&(b.Pb(0),b.Rb(1,"small",41),b.yc(2," ISBN is a 13-digit long numeric code "),b.Qb(),b.Ob())}function ve(e,t){if(1&e&&(b.Pb(0),b.wc(1,ke,3,0,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.isbn.errors)}}function ye(e,t){1&e&&(b.Pb(0),b.yc(1," Fill out the description "),b.Ob())}function Re(e,t){if(1&e&&(b.Pb(0),b.yc(1),b.Ob()),2&e){const e=b.bc().ngIf;b.zb(1),b.Ac(" The description is too long (max ",null==e||null==e.maxlength?null:e.maxlength.requiredLength," characters allowed). ")}}function Qe(e,t){1&e&&(b.Pb(0),b.yc(1," Description should start with a capital letter "),b.Ob())}function we(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"small",42),b.wc(2,ye,2,0,"ng-container",11),b.wc(3,Re,2,1,"ng-container",11),b.wc(4,Qe,2,0,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf;b.zb(2),b.hc("ngIf",null==e?null:e.required),b.zb(1),b.hc("ngIf",null==e?null:e.maxlength),b.zb(1),b.hc("ngIf",null==e?null:e.pattern)}}function ze(e,t){if(1&e&&(b.Pb(0),b.wc(1,we,5,3,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.description.errors)}}function Oe(e,t){1&e&&(b.Pb(0),b.yc(1," Fill out at least one author "),b.Ob())}function Ie(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"small",43),b.wc(2,Oe,2,0,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf;b.zb(2),b.hc("ngIf",null==e?null:e.required)}}function Me(e,t){if(1&e&&(b.Pb(0),b.wc(1,Ie,3,1,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.author.errors)}}function Pe(e,t){1&e&&(b.Pb(0),b.yc(1," Fill out the publisher "),b.Ob())}function xe(e,t){if(1&e&&(b.Pb(0),b.yc(1),b.Ob()),2&e){const e=b.bc().ngIf;b.zb(1),b.Ac(" The publisher is too long (max allowed are ",null==e||null==e.maxlength?null:e.maxlength.requiredLength," characters). ")}}function Le(e,t){if(1&e&&(b.Pb(0),b.yc(1),b.Ob()),2&e){const e=b.bc().ngIf;b.zb(1),b.Ac(" The publisher is too short (min allowed are ",null==e||null==e.minlength?null:e.minlength.requiredLength," characters). ")}}function Ce(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"small",44),b.wc(2,Pe,2,0,"ng-container",11),b.wc(3,xe,2,1,"ng-container",11),b.wc(4,Le,2,1,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf;b.zb(2),b.hc("ngIf",null==e?null:e.required),b.zb(1),b.hc("ngIf",null==e?null:e.maxlength),b.zb(1),b.hc("ngIf",null==e?null:e.minlength)}}function Se(e,t){if(1&e&&(b.Pb(0),b.wc(1,Ce,5,3,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.publisher.errors)}}function Be(e,t){1&e&&(b.Pb(0),b.yc(1," Fill out the published year "),b.Ob())}function je(e,t){if(1&e&&(b.Pb(0),b.yc(1),b.Ob()),2&e){const e=b.bc().ngIf;b.zb(1),b.Bc(" Enter a valid year (",null==e||null==e.range?null:e.range.min," - ",null==e||null==e.range?null:e.range.max,") ")}}function Ae(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"small",45),b.wc(2,Be,2,0,"ng-container",11),b.wc(3,je,2,2,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf;b.zb(2),b.hc("ngIf",null==e?null:e.required),b.zb(1),b.hc("ngIf",null==e?null:e.range)}}function Te(e,t){if(1&e&&(b.Pb(0),b.wc(1,Ae,4,2,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.published.errors)}}function qe(e,t){1&e&&(b.Pb(0),b.yc(1," Fill out the number of pages "),b.Ob())}function Fe(e,t){if(1&e&&(b.Pb(0),b.yc(1),b.Ob()),2&e){const e=b.bc().ngIf;b.zb(1),b.Bc(" Enter a valid amount (",null==e||null==e.range?null:e.range.min," - ",null==e||null==e.range?null:e.range.max,") ")}}function Ne(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"small",46),b.wc(2,qe,2,0,"ng-container",11),b.wc(3,Fe,2,2,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf;b.zb(2),b.hc("ngIf",null==e?null:e.required),b.zb(1),b.hc("ngIf",null==e?null:e.range)}}function _e(e,t){if(1&e&&(b.Pb(0),b.wc(1,Ne,4,2,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.pages.errors)}}function De(e,t){1&e&&(b.Pb(0),b.yc(1," Fill out a valid web address "),b.Ob())}function $e(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"small",47),b.wc(2,De,2,0,"ng-container",11),b.Qb(),b.Ob()),2&e){const e=t.ngIf;b.zb(2),b.hc("ngIf",null==e?null:e.pattern)}}function Ye(e,t){if(1&e&&(b.Pb(0),b.wc(1,$e,3,1,"ng-container",11),b.Ob()),2&e){const e=b.bc();b.zb(1),b.hc("ngIf",e.form.controls.website.errors)}}const Ee=function(){return["../","add"]},Ge=function(){return["../"]};let Ve=(()=>{class e{constructor(e,t,n,i,o,b){this.fb=e,this.router=t,this.route=n,this.confirmationService=i,this.booksService=o,this.breadcrumbService=b,this.unsubscribe=new g.a;const c=new Date;this.form=this.fb.group({title:this.fb.control(null,[w.l.required,w.l.maxLength(120),w.l.pattern('^(?!d+$)(?:[a-zA-Z0-9][a-zA-Z0-9 @"#&*!]*)?$')]),subtitle:this.fb.control(null,[w.l.maxLength(120),w.l.pattern('^(?!d+$)(?:[a-zA-Z0-9][a-zA-Z0-9 @"#&*!]*)?$')]),description:this.fb.control(null,[w.l.required,w.l.maxLength(512),w.l.pattern("^[A-Z].*")]),categories:this.fb.control([]),author:this.fb.control([],[w.l.required]),isbn:this.fb.control(null,[w.l.required,w.l.pattern("^[0-9]{13}")]),pages:this.fb.control(null,[w.l.required,be.range(1,9999)]),published:this.fb.control(null,[w.l.required,be.range(1900,c.getFullYear())]),publisher:this.fb.control(null,[w.l.required,w.l.minLength(5),w.l.maxLength(60)]),website:this.fb.control(null,w.l.pattern("(https?://)?([\\da-z.-]+)\\.([a-z.]{2,6})[/\\w .-]*/?")),image:this.fb.control(null)})}ngOnInit(){this.router.events.pipe(Object(ie.a)(e=>e instanceof i.b),Object(m.a)(this.unsubscribe)).subscribe(()=>{this.form.reset(),this.form.markAsPristine()}),this.route.parent.data.pipe(Object(l.a)(e=>e.bookGenres),Object(m.a)(this.unsubscribe)).subscribe(e=>{this.genreSelectItems=e.map(e=>({label:e.label,value:e.id}))}),this.route.params.pipe(Object(m.a)(this.unsubscribe)).subscribe(e=>{var t;if(e&&e.isbn){this.isEditMode=!0;const{book:e}=this.route.snapshot.data;this.breadcrumbService.pushItem({id:"books-edit",label:e.isbn,routerLink:["/books",e.isbn]});let n=e.published;isNaN(Number(n))&&(n=new Date(n).getFullYear());let i=e.author;Array.isArray(i)||(i=[i]),this.form.patchValue(Object.assign(Object.assign({},e),{published:n,author:i})),null===(t=this.form.get("isbn"))||void 0===t||t.disable()}else this.breadcrumbService.pushItem({id:"books-add",label:"New",routerLink:["/books","add"]})})}ngOnDestroy(){this.breadcrumbService.removeItem(this.isEditMode?"books-edit":"books-add"),this.unsubscribe.next(),this.unsubscribe.complete()}submit(){if(this.form.markAllAsTouched(),this.form.valid){const e=this.form.getRawValue();this.isEditMode?this.booksService.updateBook(e.isbn,e).pipe(Object(m.a)(this.unsubscribe)).subscribe(()=>{this.form.markAsPristine(),this.router.navigate(["../"],{relativeTo:this.route})}):this.booksService.createBook(e).pipe(Object(m.a)(this.unsubscribe)).subscribe(()=>{this.form.markAsPristine(),this.router.navigate(["../"],{relativeTo:this.route})})}}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(w.b),b.Lb(i.c),b.Lb(i.a),b.Lb(k.a),b.Lb(u),b.Lb(c.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["app-add-edit-book"]],features:[b.yb([k.a])],decls:81,vars:29,consts:[[1,"p-grid","p-align-center"],[1,"p-col"],[1,"p-my-0"],[1,"p-col-fixed"],["pButton","","label","Another Book",3,"icon","routerLink"],[1,"p-mt-3",3,"formGroup","ngSubmit"],[1,"p-grid"],[1,"p-col-12","p-sm-6"],[1,"p-field"],["for","title"],["id","title","type","text","pInputText","","formControlName","title","aria-describedby","title-help"],[4,"ngIf"],["for","subtitle"],["id","subtitle","type","text","pInputText","","formControlName","subtitle","aria-describedby","subtitle-help"],["for","categories"],["formControlName","categories",3,"options","selectionLimit","maxSelectedLabels","inputId","defaultLabel","selectedItemsLabel","showToggleAll"],["for","isbn"],["id","isbn","type","text","pInputText","","formControlName","isbn","aria-describedby","isbn-help"],["formControlName","image"],[1,"p-col-12"],["for","description"],["id","description","type","text","rows","4","pInputTextarea","","formControlName","description","aria-describedby","description-help"],["for","author"],["formControlName","author","aria-describedby","author-help",3,"addOnBlur","addOnTab","allowDuplicate","max","inputId"],["for","publisher"],["id","publisher","type","text","pInputText","","formControlName","publisher","aria-describedby","publisher-help"],["for","published"],["id","published","type","number","pInputText","","formControlName","published","aria-describedby","published-help"],["for","pages"],["id","pages","type","number","pInputText","","formControlName","pages","aria-describedby","pages-help"],["for","website"],["id","website","type","text","pInputText","","formControlName","website","aria-describedby","website-help"],[1,"p-grid","p-justify-end"],["pButton","","type","submit","label","Save",1,"ui-button-primary"],["pButton","","type","button","label","Cancel",3,"routerLink"],["appendTo","body","styleClass","ui-dialog-headless",3,"closable"],["cd",""],["pButton","","label","CANCEL","tabindex","0","autofocus","",3,"click"],["pButton","","label","DISCARD","tabindex","1",1,"ui-button-danger",3,"click"],["id","title-help",1,"invalid-feedback"],["id","subtitle-help",1,"invalid-feedback"],["id","isbn-help",1,"invalid-feedback"],["id","description-help",1,"invalid-feedback"],["id","author-help",1,"invalid-feedback"],["id","publisher-help",1,"invalid-feedback"],["id","published-help",1,"invalid-feedback"],["id","pages-help",1,"invalid-feedback"],["id","website-help",1,"invalid-feedback"]],template:function(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",0),b.Rb(1,"div",1),b.Rb(2,"h1",2),b.yc(3),b.Qb(),b.Qb(),b.Rb(4,"div",3),b.Mb(5,"a",4),b.Qb(),b.Qb(),b.Rb(6,"form",5),b.Yb("ngSubmit",(function(){return t.submit()})),b.Rb(7,"div",6),b.Rb(8,"div",7),b.Rb(9,"div",8),b.Rb(10,"label",9),b.yc(11,"Title"),b.Qb(),b.Mb(12,"input",10),b.wc(13,pe,2,1,"ng-container",11),b.Qb(),b.Rb(14,"div",8),b.Rb(15,"label",12),b.yc(16,"Subtitle"),b.Qb(),b.Mb(17,"input",13),b.wc(18,me,2,1,"ng-container",11),b.Qb(),b.Rb(19,"div",8),b.Rb(20,"label",14),b.yc(21,"Categories"),b.Qb(),b.Mb(22,"p-multiSelect",15),b.Qb(),b.Rb(23,"div",8),b.Rb(24,"label",16),b.yc(25,"ISBN"),b.Qb(),b.Mb(26,"input",17),b.wc(27,ve,2,1,"ng-container",11),b.Qb(),b.Qb(),b.Rb(28,"div",7),b.Rb(29,"div",8),b.Rb(30,"label",9),b.yc(31,"Image"),b.Qb(),b.Rb(32,"div"),b.Mb(33,"app-imageupload",18),b.Qb(),b.Qb(),b.Qb(),b.Rb(34,"div",19),b.Rb(35,"div",8),b.Rb(36,"label",20),b.yc(37,"Description"),b.Qb(),b.Mb(38,"textarea",21),b.wc(39,ze,2,1,"ng-container",11),b.Qb(),b.Qb(),b.Rb(40,"div",19),b.Rb(41,"div",8),b.Rb(42,"label",22),b.yc(43,"Author(s)"),b.Qb(),b.Mb(44,"p-chips",23),b.wc(45,Me,2,1,"ng-container",11),b.Qb(),b.Qb(),b.Rb(46,"div",7),b.Rb(47,"div",8),b.Rb(48,"label",24),b.yc(49,"Publisher"),b.Qb(),b.Mb(50,"input",25),b.wc(51,Se,2,1,"ng-container",11),b.Qb(),b.Qb(),b.Rb(52,"div",7),b.Rb(53,"div",6),b.Rb(54,"div",7),b.Rb(55,"div",8),b.Rb(56,"label",26),b.yc(57,"Published Year"),b.Qb(),b.Mb(58,"input",27),b.wc(59,Te,2,1,"ng-container",11),b.Qb(),b.Qb(),b.Rb(60,"div",7),b.Rb(61,"div",8),b.Rb(62,"label",28),b.yc(63,"Amount of Pages"),b.Qb(),b.Mb(64,"input",29),b.wc(65,_e,2,1,"ng-container",11),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(66,"div",7),b.Rb(67,"div",8),b.Rb(68,"label",30),b.yc(69,"Website"),b.Qb(),b.Mb(70,"input",31),b.wc(71,Ye,2,1,"ng-container",11),b.Qb(),b.Qb(),b.Qb(),b.Rb(72,"div",32),b.Rb(73,"div",3),b.Mb(74,"button",33),b.Mb(75,"button",34),b.Qb(),b.Qb(),b.Qb(),b.Rb(76,"p-confirmDialog",35,36),b.Rb(78,"p-footer"),b.Rb(79,"button",37),b.Yb("click",(function(){return b.qc(e),b.pc(77).reject()})),b.Qb(),b.Rb(80,"button",38),b.Yb("click",(function(){return b.qc(e),b.pc(77).accept()})),b.Qb(),b.Qb(),b.Qb()}2&e&&(b.zb(3),b.Ac(" ",t.isEditMode?"Edit Book":"Add new Book"," "),b.zb(2),b.hc("icon","pi pi-plus")("routerLink",b.ic(27,Ee)),b.zb(1),b.hc("formGroup",t.form),b.zb(7),b.hc("ngIf",t.form.controls.title.touched),b.zb(5),b.hc("ngIf",t.form.controls.subtitle.touched),b.zb(4),b.hc("options",t.genreSelectItems)("selectionLimit",4)("maxSelectedLabels",4)("inputId","categories")("defaultLabel","Select")("selectedItemsLabel","{0} categories selected")("showToggleAll",!1),b.zb(5),b.hc("ngIf",t.form.controls.isbn.touched),b.zb(12),b.hc("ngIf",t.form.controls.description.touched),b.zb(5),b.hc("addOnBlur",!0)("addOnTab",!0)("allowDuplicate",!1)("max",3)("inputId","author"),b.zb(1),b.hc("ngIf",t.form.controls.author.touched),b.zb(6),b.hc("ngIf",t.form.controls.publisher.touched),b.zb(8),b.hc("ngIf",t.form.controls.published.touched),b.zb(6),b.hc("ngIf",t.form.controls.pages.touched),b.zb(6),b.hc("ngIf",t.form.controls.website.touched),b.zb(4),b.hc("routerLink",b.ic(28,Ge)),b.zb(1),b.hc("closable",!1))},directives:[i.f,v.b,w.m,w.h,w.d,w.a,z.a,w.g,w.c,y.k,M.a,ce.a,re.a,le.a,w.j,i.d,Q.a,k.b],styles:["[_nghost-%COMP%]{box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,.132),0 .3px .9px 0 rgba(0,0,0,.108);border-radius:.125rem;background-color:#fff;display:block;padding:1rem}"]}),e})();const He=[{path:"",component:r,resolve:{bookGenres:d},children:[{path:"",component:_,resolve:{books:p}},{path:"add",component:Ve,canDeactivate:[$],runGuardsAndResolvers:"always"},{path:":isbn",component:Ve,canDeactivate:[$],resolve:{book:h}},{path:":isbn/view",component:ne,resolve:{book:h,similarBooks:f}}]}];let Ze=(()=>{class e{}return e.\u0275mod=b.Jb({type:e}),e.\u0275inj=b.Ib({factory:function(t){return new(t||e)},imports:[[o.a,i.g.forChild(He)]]}),e})()}}]);